{"version":3,"sources":["../src/index.js"],"names":["CubeGallery","id","minHeight","margin","unit","gallery","document","querySelector","style","fontSize","lineHeight","extra","wrapper","querySelectorAll","length","findExtraWidth","forEach","a","display","position","img","loadData","window","addEventListener","resize","galleryWidth","offsetWidth","images","width","Math","floor","naturalWidth","naturalHeight","height","nbImages","elm","borders","getComputedStyle","borderLeft","Number","borderLeftWidth","substr","borderRight","borderRightWidth","prototype","create","rows","imgs","sumOfWidth","i","currentImg","nextImg","undefined","push"],"mappings":"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","file":"cube-gallery.js","sourcesContent":["class CubeGallery {\n    constructor(id, { minHeight, margin }) {\n        // selector\n        this.id = id\n        // min height\n        this.minHeight = minHeight && minHeight > 0 ? minHeight : 150\n        // unit\n        this.unit = 'px'\n        // margin\n        this.margin = margin && margin > 0 ? margin : 0\n        \n        // gallery container\n        this.gallery = document.querySelector(`#${ this.id }`)\n        this.gallery.style.fontSize = '0' // remove white spaces\n        this.gallery.style.lineHeight = '0' // remove white spaces\n\n        // extra borders or padding or margins that can be added with css\n        this.extra = 0\n        \n        // img wrapper <a>\n        let wrapper = document.querySelectorAll(`#${ this.id } a`)\n        if (wrapper.length > 0) {\n            this.findExtraWidth(wrapper[0])\n            wrapper.forEach(a => {\n                a.style.display = 'inline-block'\n                a.style.position = 'relative'\n            })\n        }\n\n        let img = document.querySelectorAll(`#${ this.id } img`)\n        this.findExtraWidth(img[0])\n\n        // variable data\n        this.loadData()\n        \n        window.addEventListener('resize', () => {\n            this.resize()\n        })\n    }\n\n    loadData () {\n        // gallery width\n        this.galleryWidth = this.gallery.offsetWidth\n\n        // images\n        this.images = document.querySelectorAll(`#${ this.id } img`)\n        this.images.forEach(img => {\n            img.width = Math.floor(img.naturalWidth * this.minHeight / img.naturalHeight), // default width\n            img.height = this.minHeight // default height\n        })\n        // count images\n        this.nbImages = this.images.length\n    }\n\n    // check if element has borders\n    findExtraWidth (elm) {\n        let borders = getComputedStyle(elm)\n        let borderLeft = Number(borders.borderLeftWidth.substr(0, borders.borderLeftWidth.length - 2))\n        let borderRight = Number(borders.borderRightWidth.substr(0, borders.borderLeftWidth.length - 2))\n        this.extra = this.extra + borderLeft + borderRight\n    }\n}\n\nCubeGallery.prototype.resize = function () {\n    this.loadData()\n    return this.create()\n}\n\nCubeGallery.prototype.create = function () { \n    var rows = []\n    var imgs = []\n    var sumOfWidth = 0 // sum of the width of the images\n    for (let i = 0; i < this.nbImages; i++) {\n        let currentImg = this.images[i]\n        let nextImg = this.images[i+1] != undefined ? this.images[i+1] : null\n\n        sumOfWidth = Math.floor(sumOfWidth + currentImg.width)\n\n        imgs.push(currentImg)\n\n        if (nextImg == null || Math.floor(sumOfWidth + nextImg.width) > this.galleryWidth) { // if row is filled\n            rows.push(imgs)\n            sumOfWidth = 0\n            imgs = []\n        }\n    }\n\n    rows.forEach(imgs => {\n        let sumOfWidth = 0 // sum of the width of the images\n        imgs.forEach(img => sumOfWidth = Math.floor(sumOfWidth + img.width))\n        imgs.forEach(img => {\n            img.width = Math.floor((img.width * (img.height * this.galleryWidth / sumOfWidth) / img.height) - (this.margin * 2) - this.extra)\n            img.height = Math.floor((img.height * this.galleryWidth / sumOfWidth) - (this.margin * 2) - this.extra)\n            img.style.margin = this.margin + 'px'\n        })\n    })\n\n    return this\n}"]}